<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Theme Init - Zero-FOUC theme loading (must be first script) -->
    <script>
      (function() {
        'use strict';
        try {
          const ls = localStorage.getItem('theme'); // 'light' | 'dark' | 'system'
          const brand = localStorage.getItem('brand') || 'cmo'; // default: cmo
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          const theme = ls === 'system' || !ls ? (prefersDark ? 'dark' : 'light') : ls;
          const isDark = theme === 'dark';

          document.documentElement.classList.toggle('dark', isDark);
          document.documentElement.setAttribute('data-brand', brand);

          // Update theme-color meta tag immediately (for Chrome/Edge/Safari)
          // Firefox and Opera ignore this tag - we use CSS color-scheme for them instead
          const themeColorMeta = document.querySelector('meta[name="theme-color"]');
          if (themeColorMeta) {
            themeColorMeta.setAttribute('content', isDark ? '#0b0b0c' : '#ffffff');
          }

          // Set CSS color-scheme for Firefox/Opera support
          document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';
        } catch(e) {
          // Silently fail if localStorage is unavailable
        }
      })();
    </script>

    <!-- Primary Meta Tags -->
    <title>Jacob Darling — Marketing Strategist & Systems Architect</title>
    <meta name="title" content="Jacob Darling — Marketing Strategist & Marketing Technologist" />
    <meta name="description" content="Results-driven marketing professional specializing in digital marketing strategies, campaign automation, CRM integration, SEO/SEM, and analytics-driven strategy. Proven results: 400+ marketing automations, 70% ticket reduction, 40% conversion increase." />
    <meta name="keywords" content="marketing strategist, marketing technologist, marketing automation, CRM campaigns, SEO SEM, digital marketing, campaign automation, marketing ROI, Google Ads, Meta Ads, LinkedIn Ads, analytics-driven strategy, cross-functional project management, marketing manager, marketing systems architect" />
    <meta name="author" content="Jacob Darling" />
    <meta name="robots" content="index, follow" />

    <!-- Theme Color -->
    <!-- Note: theme-color is supported by Chrome/Edge and Safari for browser chrome theming.
          Firefox and Opera do not support this meta tag - we use CSS color-scheme property for those browsers.
          The value is dynamically updated by ThemeProvider based on the current theme. -->
    <meta name="theme-color" content="#ffffff" />
    <meta name="msapplication-TileColor" content="#0b0b0c" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://jacobdarling.com/" />
    <meta property="og:title" content="Jacob Darling — Marketing Strategist & Systems Architect" />
    <meta property="og:description" content="Results-driven marketing professional specializing in digital marketing strategies, campaign automation, and CRM integration. Proven track record: 400+ automations, 70% ticket reduction, 40% conversion increase." />
    <meta property="og:image" content="https://jacobdarling.com/og-image.jpg" />
    <meta property="og:site_name" content="Jacob Darling Portfolio" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://jacobdarling.com/" />
    <meta name="twitter:title" content="Jacob Darling — Marketing Strategist & Marketing Technologist" />
    <meta name="twitter:description" content="Marketing automation expert: 400+ workflows, 70% ticket reduction, 40% conversion increase. Specializing in CRM campaigns, SEO/SEM, and analytics-driven strategy." />
    <meta name="twitter:image" content="https://jacobdarling.com/og-image.jpg" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://jacobdarling.com/" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&family=Newsreader:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

    <!-- Critical Resource Preloading -->
    <!-- Note: Vite will handle resource preloading automatically in production -->

    <!-- DNS Prefetch for External Resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />

    <!-- Custom Element Registration Guard - Prevents duplicate registration errors -->
    <!-- This intercepts ALL customElements.define() calls to prevent re-registration -->
    <script>
      (function () {
        'use strict';

        if (typeof window === "undefined" || !window.customElements) return;

        const originalDefine = window.customElements.define;
        if (!originalDefine) return;

        // Prevent double-wrapping
        if (window.customElements.__defineGuardInstalled) return;
        window.customElements.__defineGuardInstalled = true;

        // Override customElements.define to check before defining
        window.customElements.define = function (name, constructor, options) {
          // Check if element is already defined - this is the recommended pattern
          if (window.customElements.get(name)) {
            // Element already exists - skip re-registration
            if (process?.env?.NODE_ENV === 'development' || window.location.hostname === 'localhost') {
              console.warn(`Custom element "${name}" is already registered. Skipping re-registration.`);
            }
            return;
          }

          // Element doesn't exist yet - safe to define
          try {
            return originalDefine.call(this, name, constructor, options);
          } catch (error) {
            // Handle race conditions where element might be defined between check and call
            const errorMsg = error?.message || String(error);
            if (errorMsg && errorMsg.includes('has already been used') ||
                errorMsg.includes('has already been defined')) {
              // Race condition - element was defined by another script between check and call
              if (process?.env?.NODE_ENV === 'development' || window.location.hostname === 'localhost') {
                console.warn(`Custom element "${name}" was defined by another script during registration. Skipping.`);
              }
              return; // Silently skip duplicate definitions
            }
            // Re-throw other errors (not duplicate registration errors)
            throw error;
          }
        };
      })();
    </script>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Jacob Darling",
      "jobTitle": "Marketing Strategist & Marketing Technologist",
      "url": "https://jacobdarling.com",
      "worksFor": {
        "@type": "Organization",
        "name": "Marketing Strategist & Systems Architect"
      },
      "sameAs": [
        "https://linkedin.com/in/jacobdarling",
        "https://github.com/JdarlingGT"
      ],
      "description": "Results-driven marketing professional specializing in digital marketing strategies, campaign automation, CRM integration, and analytics-driven strategy with proven ROI.",
      "knowsAbout": [
        "Marketing Automation",
        "CRM Campaigns",
        "Digital Marketing Strategy",
        "SEO/SEM",
        "Google Ads",
        "Meta Ads",
        "LinkedIn Ads",
        "Analytics-Driven Strategy",
        "Campaign Automation",
        "Marketing ROI",
        "Cross-Functional Project Management",
        "Marketing Technologist"
      ]
    }
    </script>
    <!-- Preload React for faster initialization -->
    <link rel="modulepreload" href="/src/main.tsx" />

    <!-- Critical CSS for initial render -->
    <style>
      * { box-sizing: border-box; }
      html, body {
        margin: 0;
        padding: 0;
        background-color: #0A0A0A;
        color: #FFFFFF;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      #root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .initial-loader {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background-color: #0A0A0A;
        color: #FFFFFF;
      }
      .initial-loader-content {
        text-align: center;
      }
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255,255,255,0.1);
        border-top-color: #3B82F6;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin: 0 auto 1rem;
      }
      .initial-loader-text {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        opacity: 0.7;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      .noscript-message {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        background-color: #0A0A0A;
        color: #FFFFFF;
        text-align: center;
        padding: 2rem;
      }
      .noscript-message h1 {
        font-family: 'Inter', sans-serif;
        margin-bottom: 1rem;
      }
      .noscript-message p {
        font-family: 'Inter', sans-serif;
        opacity: 0.7;
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div class="initial-loader">
        <div class="initial-loader-content">
          <div class="spinner"></div>
          <p class="initial-loader-text">Loading portfolio...</p>
        </div>
      </div>
    </div>
    <noscript>
      <div class="noscript-message">
        <div>
          <h1>JavaScript Required</h1>
          <p>This portfolio requires JavaScript to function. Please enable JavaScript in your browser settings.</p>
        </div>
      </div>
    </noscript>
    <!-- Vite will automatically inject the correct entry script during build -->
    <script type="module" crossorigin src="/src/main.tsx"></script>

    <!-- Enhanced error detection for production -->
    <script>
      // Enhanced error detection to help diagnose loading issues
      window.addEventListener('error', function(e) {
        console.error('Global error caught:', {
          message: e.message,
          filename: e.filename,
          lineno: e.lineno,
          colno: e.colno,
          error: e.error
        });

        // If it's a module loading error, show helpful message
        if (e.message && (e.message.includes('Failed to fetch') ||
                          e.message.includes('module script') ||
                          e.message.includes('MIME type') ||
                          e.message.includes('net::ERR'))) {
          const root = document.getElementById('root');
          if (root && root.querySelector('.initial-loader')) {
            root.innerHTML = `
              <style>
                .error-container {
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  min-height: 100vh;
                  background: #0A0A0A;
                  color: #FFFFFF;
                  padding: 2rem;
                  text-align: center;
                }
                .error-title {
                  font-size: 1.5rem;
                  margin-bottom: 1rem;
                  color: #EF4444;
                }
                .error-message {
                  opacity: 0.8;
                  margin-bottom: 1rem;
                  font-family: monospace;
                  font-size: 0.9rem;
                }
                .error-button {
                  margin-top: 1rem;
                  padding: 0.75rem 2rem;
                  background: #3B82F6;
                  color: white;
                  border: none;
                  border-radius: 8px;
                  cursor: pointer;
                }
              </style>
              <div class="error-container">
                <div>
                  <h2 class="error-title">Script Loading Error</h2>
                  <p class="error-message">${e.message}</p>
                  <p style="opacity: 0.7; margin-top: 1rem;">
                    The application scripts failed to load. This might be a network issue or a build configuration problem.
                  </p>
                  <button class="error-button" onclick="window.location.reload()">
                    Reload Page
                  </button>
                </div>
              </div>
            `;
          }
        }
      }, true);

      // Also catch unhandled promise rejections
      window.addEventListener('unhandledrejection', function(e) {
        console.error('Unhandled promise rejection:', e.reason);
      });

      // Timeout to detect if nothing loads after 15 seconds
      setTimeout(function() {
        const root = document.getElementById('root');
        if (root && root.querySelector('.initial-loader')) {
          console.error('Application failed to load after 15 seconds');
          root.innerHTML = `
            <style>
              .timeout-container {
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background: #0A0A0A;
                color: #FFFFFF;
                padding: 2rem;
                text-align: center;
              }
              .timeout-title {
                font-size: 1.5rem;
                margin-bottom: 1rem;
                color: #F59E0B;
              }
              .timeout-button {
                margin-top: 1rem;
                padding: 0.75rem 2rem;
                background: #3B82F6;
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
              }
            </style>
            <div class="timeout-container">
              <div>
                <h2 class="timeout-title">Loading Timeout</h2>
                <p style="opacity: 0.8; margin-bottom: 1rem;">
                  The application is taking longer than expected to load.
                </p>
                <p style="opacity: 0.6; font-size: 0.9rem; margin-bottom: 1rem;">
                  Please check the browser console (F12) for errors.
                </p>
                <button class="timeout-button" onclick="window.location.reload()">
                  Reload Page
                </button>
              </div>
            </div>
          `;
        }
      }, 15000);
    </script>
  </body>
</html>
